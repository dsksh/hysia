(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     33274,        823]
NotebookOptionsPosition[     32623,        799]
NotebookOutlinePosition[     33092,        817]
CellTagsIndexPosition[     33049,        814]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Box2g", "[", "u_", "]"}], ":=", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{"First", "[", "u", "]"}], "]"}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{"Last", "[", "u", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"First", "[", "u", "]"}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"Last", "[", "u", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Box2g", "[", 
     RowBox[{"ix_", ",", "iy_", ",", "u_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"value", ",", "min", ",", "max", ",", "mid"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"value", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", 
          RowBox[{"u", "[", 
           RowBox[{"[", "iy", "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"min", "=", 
        RowBox[{"Min", "/@", "value"}]}], ";", " ", 
       RowBox[{"max", "=", 
        RowBox[{"Max", "/@", "value"}]}], ";", " ", 
       RowBox[{"mid", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Max", "[", "#", "]"}], "+", 
             RowBox[{"Min", "[", "#", "]"}]}], ")"}], "/", "2"}], "&"}], "/@",
          "value"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Rectangle", "[", 
          RowBox[{"min", ",", "max"}], "]"}], ",", 
         RowBox[{"PointSize", "[", "Large", "]"}], ",", "Black", ",", 
         RowBox[{"Point", "[", "mid", "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Pped2g", "[", 
     RowBox[{"ix_", ",", "iy_", ",", " ", 
      RowBox[{"pped", "[", 
       RowBox[{"x_", ",", "m_", ",", "u_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "m1", ",", "u1"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", " ", 
          RowBox[{"x", "[", 
           RowBox[{"[", "iy", "]"}], "]"}]}], "}"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"m1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", "ix"}], "]"}], "]"}], ",", " ", 
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", "iy"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"iy", ",", "ix"}], "]"}], "]"}], ",", " ", 
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"iy", ",", "iy"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"u1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", " ", 
          RowBox[{"u", "[", 
           RowBox[{"[", "iy", "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"GeometricTransformation", "[", 
          RowBox[{
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"First", "[", "u1", "]"}], "]"}], ",", 
               RowBox[{"Min", "[", 
                RowBox[{"Last", "[", "u1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"First", "[", "u1", "]"}], "]"}], ",", 
               RowBox[{"Max", "[", 
                RowBox[{"Last", "[", "u1", "]"}], "]"}]}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"AffineTransform", "[", 
            RowBox[{"{", 
             RowBox[{"m1", ",", "x1"}], "}"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PointSize", "[", "Large", "]"}], ",", "Red", ",", 
         RowBox[{"Point", "[", "x1", "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PpedD2g", "[", 
     RowBox[{"ix_", ",", "iy_", ",", 
      RowBox[{"pped2", "[", 
       RowBox[{"x_", ",", "m_", ",", "u_", ",", " ", "n_", ",", " ", "v_"}], 
       "]"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "m1", ",", "u1", ",", "n1", ",", "v1"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", " ", 
          RowBox[{"x", "[", 
           RowBox[{"[", "iy", "]"}], "]"}]}], "}"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"m1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", "ix"}], "]"}], "]"}], ",", " ", 
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", "iy"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"iy", ",", "ix"}], "]"}], "]"}], ",", " ", 
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"iy", ",", "iy"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"u1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", " ", 
          RowBox[{"u", "[", 
           RowBox[{"[", "iy", "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", "ix"}], "]"}], "]"}], ",", " ", 
            RowBox[{"n", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", "iy"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"n", "[", 
             RowBox[{"[", 
              RowBox[{"iy", ",", "ix"}], "]"}], "]"}], ",", " ", 
            RowBox[{"n", "[", 
             RowBox[{"[", 
              RowBox[{"iy", ",", "iy"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"v1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", " ", 
          RowBox[{"v", "[", 
           RowBox[{"[", "iy", "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"GeometricTransformation", "[", 
           RowBox[{
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{"First", "[", "u1", "]"}], "]"}], "+", 
                 RowBox[{"Min", "[", 
                  RowBox[{"First", "[", "v1", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{"Last", "[", "u1", "]"}], "]"}], "+", 
                 RowBox[{"Min", "[", 
                  RowBox[{"Last", "[", "v1", "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"First", "[", "u1", "]"}], "]"}], "+", 
                 RowBox[{"Max", "[", 
                  RowBox[{"First", "[", "v1", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"Last", "[", "u1", "]"}], "]"}], "+", 
                 RowBox[{"Max", "[", 
                  RowBox[{"Last", "[", "v1", "]"}], "]"}]}]}], "}"}]}], "]"}],
             ",", 
            RowBox[{"AffineTransform", "[", 
             RowBox[{"{", 
              RowBox[{"m1", ",", "x1"}], "}"}], "]"}]}], "]"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"GeometricTransformation", "[", 
          RowBox[{
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"First", "[", "u1", "]"}], "]"}], ",", 
               RowBox[{"Min", "[", 
                RowBox[{"Last", "[", "u1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"First", "[", "u1", "]"}], "]"}], ",", 
               RowBox[{"Max", "[", 
                RowBox[{"Last", "[", "u1", "]"}], "]"}]}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"AffineTransform", "[", 
            RowBox[{"{", 
             RowBox[{"m1", ",", "x1"}], "}"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PointSize", "[", "Large", "]"}], ",", "Red", ",", 
         RowBox[{"Point", "[", "x1", "]"}]}], "}"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pped2g", "[", 
    RowBox[{"ix_", ",", "iy_", ",", 
     RowBox[{"box", "[", "v_", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"value", ",", "min", ",", "max", ",", "mid"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"value", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "ix", "]"}], "]"}], ",", 
         RowBox[{"v", "[", 
          RowBox[{"[", "iy", "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"min", "=", 
       RowBox[{"Min", "/@", "value"}]}], ";", " ", 
      RowBox[{"max", "=", 
       RowBox[{"Max", "/@", "value"}]}], ";", " ", 
      RowBox[{"mid", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", "#", "]"}], "+", 
            RowBox[{"Min", "[", "#", "]"}]}], ")"}], "/", "2"}], "&"}], "/@", 
        "value"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"{", 
          RowBox[{"Thin", ",", "Black"}], "}"}], "]"}], ",", 
        RowBox[{"FaceForm", "[", 
         RowBox[{"Opacity", "[", 
          RowBox[{"0.1", ",", "LightGray"}], "]"}], "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{"min", ",", "max"}], "]"}], ",", 
        RowBox[{"PointSize", "[", "Large", "]"}], ",", "Black", ",", 
        RowBox[{"Point", "[", "mid", "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pped2g", "[", 
     RowBox[{"ix_", ",", "iy_", ",", 
      RowBox[{"pped", "[", 
       RowBox[{"x_", ",", "m_", ",", "u_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "m1", ",", "u1"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", " ", 
          RowBox[{"x", "[", 
           RowBox[{"[", "iy", "]"}], "]"}]}], "}"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"m1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", "ix"}], "]"}], "]"}], ",", " ", 
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", "iy"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"iy", ",", "ix"}], "]"}], "]"}], ",", " ", 
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"iy", ",", "iy"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"u1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", " ", 
          RowBox[{"u", "[", 
           RowBox[{"[", "iy", "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"GeometricTransformation", "[", 
          RowBox[{
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"First", "[", "u1", "]"}], "]"}], ",", 
               RowBox[{"Min", "[", 
                RowBox[{"Last", "[", "u1", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"First", "[", "u1", "]"}], "]"}], ",", 
               RowBox[{"Max", "[", 
                RowBox[{"Last", "[", "u1", "]"}], "]"}]}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"AffineTransform", "[", 
            RowBox[{"{", 
             RowBox[{"m1", ",", "x1"}], "}"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PointSize", "[", "Large", "]"}], ",", "Red", ",", 
         RowBox[{"Point", "[", "x1", "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pped2intv", "[", 
    RowBox[{"iy_", ",", 
     RowBox[{"box", "[", "v_", "]"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"Black", ",", 
     RowBox[{"v", "[", 
      RowBox[{"[", "iy", "]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pped2intv", "[", 
     RowBox[{"iy_", ",", 
      RowBox[{"pped", "[", 
       RowBox[{"x_", ",", "m_", ",", "u_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ix", "=", "1"}], ",", "x1", ",", "m1", ",", "u1"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", " ", 
          RowBox[{"x", "[", 
           RowBox[{"[", "iy", "]"}], "]"}]}], "}"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"m1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", "ix"}], "]"}], "]"}], ",", " ", 
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", "iy"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"iy", ",", "ix"}], "]"}], "]"}], ",", " ", 
            RowBox[{"m", "[", 
             RowBox[{"[", 
              RowBox[{"iy", ",", "iy"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"u1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", " ", 
          RowBox[{"u", "[", 
           RowBox[{"[", "iy", "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"u1", "=", 
        RowBox[{
         RowBox[{"m1", ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Interval", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"First", "[", "u1", "]"}], "]"}], ",", 
               RowBox[{"Min", "[", 
                RowBox[{"Last", "[", "u1", "]"}], "]"}]}], "}"}], "]"}], ",", 
            
            RowBox[{"Interval", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"First", "[", "u1", "]"}], "]"}], ",", 
               RowBox[{"Max", "[", 
                RowBox[{"Last", "[", "u1", "]"}], "]"}]}], "}"}], "]"}]}], 
           "}"}]}], "+", "x1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Red", ",", 
         RowBox[{
          RowBox[{"u1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pipe2g", "[", 
    RowBox[{"ix_", ",", "iy_", ",", 
     RowBox[{"{", 
      RowBox[{"t_", ",", "pped_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"res", ",", "value", ",", "min", ",", "max", ",", "mid"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ix", ">", "0"}], ",", 
       RowBox[{"pped2g", "[", 
        RowBox[{"ix", ",", "iy", ",", "pped"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "=", 
         RowBox[{"pped2intv", "[", 
          RowBox[{"iy", ",", "pped"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"value", "=", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"res", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"min", "=", 
         RowBox[{"Min", "/@", "value"}]}], ";", " ", 
        RowBox[{"max", "=", 
         RowBox[{"Max", "/@", "value"}]}], ";", " ", 
        RowBox[{"mid", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Max", "[", "#", "]"}], "+", 
              RowBox[{"Min", "[", "#", "]"}]}], ")"}], "/", "2"}], "&"}], "/@",
           "value"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", 
           RowBox[{"{", 
            RowBox[{"Thin", ",", "Black"}], "}"}], "]"}], ",", 
          RowBox[{"FaceForm", "[", 
           RowBox[{"Opacity", "[", 
            RowBox[{"0.1", ",", "LightGray"}], "]"}], "]"}], ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{"min", ",", "max"}], "]"}], ",", 
          RowBox[{"PointSize", "[", "Large", "]"}], ",", 
          RowBox[{"res", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Point", "[", "mid", "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.481091611324185*^9, 3.481091611752246*^9}, {
   3.481091679735217*^9, 3.4810916843007507`*^9}, {3.4810917390524187`*^9, 
   3.481091740602436*^9}, {3.4810918143929653`*^9, 3.481091878436914*^9}, {
   3.4810919107657337`*^9, 3.4810919569776907`*^9}, {3.4810920272788363`*^9, 
   3.481092074613846*^9}, {3.4810923715860147`*^9, 3.4810923783512506`*^9}, {
   3.49822016848564*^9, 3.498220197717772*^9}, {3.4996896353685093`*^9, 
   3.499689693933228*^9}, {3.499689817823552*^9, 3.499689844793182*^9}, {
   3.4996903501159487`*^9, 3.4996903815235453`*^9}, {3.499690754297616*^9, 
   3.499690831660344*^9}, {3.499691709582193*^9, 3.499691741075*^9}, {
   3.4997561366027937`*^9, 3.499756142193966*^9}, {3.499756255818763*^9, 
   3.4997562573937197`*^9}, {3.499756291037382*^9, 3.499756318984085*^9}, {
   3.499756491905897*^9, 3.499756575207447*^9}, {3.499756727675865*^9, 
   3.499756764625114*^9}, {3.499756795814242*^9, 3.499756979917541*^9}, {
   3.499757046190568*^9, 3.499757067096662*^9}, {3.499757300674118*^9, 
   3.499757306333962*^9}, {3.499757703899149*^9, 3.499757710809339*^9}, {
   3.4997577865761833`*^9, 3.499757830396347*^9}, {3.4997589366909523`*^9, 
   3.4997589383401327`*^9}, {3.499759045267144*^9, 3.499759159089864*^9}, {
   3.499772515440435*^9, 3.499772534097601*^9}, {3.499772589066474*^9, 
   3.4997725894338417`*^9}, {3.4997727659890614`*^9, 3.499772783627492*^9}, {
   3.4997731014608297`*^9, 3.4997731533166523`*^9}, {3.499773558585679*^9, 
   3.4997735610669823`*^9}, {3.499773785557044*^9, 3.499773786040985*^9}, {
   3.4997739938691998`*^9, 3.499774027940988*^9}, {3.499776571375494*^9, 
   3.499776580260133*^9}, {3.499777262855721*^9, 3.499777277174986*^9}, {
   3.4997789286686697`*^9, 3.499778992785015*^9}, {3.4997796094701014`*^9, 
   3.499779684728353*^9}, 3.499780171616837*^9, {3.499780220607747*^9, 
   3.499780242806899*^9}, {3.499780428239669*^9, 3.4997804952689743`*^9}, {
   3.4997805443402967`*^9, 3.499780553066951*^9}, {3.499780589745414*^9, 
   3.4997805999965887`*^9}, {3.499780688996888*^9, 3.499780691596816*^9}, {
   3.4997807965945797`*^9, 3.499780800088526*^9}, {3.563502886643314*^9, 
   3.5635029030942593`*^9}, {3.563502961569529*^9, 3.563502968813797*^9}, {
   3.563507618453157*^9, 3.563507726552698*^9}, {3.563507769665393*^9, 
   3.563507943702574*^9}, {3.5684234937325897`*^9, 3.568423542424753*^9}, {
   3.568423679750064*^9, 3.5684237771919737`*^9}, {3.5684238252076693`*^9, 
   3.568423881135467*^9}, {3.568424206928729*^9, 3.568424207753069*^9}, {
   3.568424308632852*^9, 3.5684243099383574`*^9}, {3.568424379599992*^9, 
   3.56842439331007*^9}, {3.56842444386243*^9, 3.568424444589169*^9}, {
   3.5684245868367863`*^9, 3.5684245891797733`*^9}, {3.56842618568469*^9, 
   3.56842618911436*^9}, {3.5684298261838913`*^9, 3.5684298437659082`*^9}, {
   3.56842999000629*^9, 3.568430094862653*^9}, {3.568439053310629*^9, 
   3.568439071833379*^9}, {3.56843917632953*^9, 3.568439195585413*^9}, {
   3.568441216449288*^9, 3.5684412264176064`*^9}, {3.568442044588673*^9, 
   3.5684420674111567`*^9}, {3.568442422305546*^9, 3.5684424794655857`*^9}, {
   3.568442590187564*^9, 3.5684426275179873`*^9}, {3.568442728111608*^9, 
   3.568442756349744*^9}, {3.568442874707862*^9, 3.568442917806417*^9}, {
   3.568442955334206*^9, 3.568442957844616*^9}, {3.568443032708014*^9, 
   3.5684430374887457`*^9}, {3.568443396212658*^9, 3.568443396952073*^9}, {
   3.568443521941551*^9, 3.5684435354153337`*^9}, {3.5684452676707973`*^9, 
   3.5684452703533363`*^9}, {3.568445300825509*^9, 3.568445426730863*^9}},
 Background->GrayLevel[0.85]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"list", " ", "=", " ", 
   RowBox[{"<<", "../src_ocaml/pped.dat"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"pipe2g", "[", 
     RowBox[{"0", ",", "2", ",", "#"}], "]"}], "&"}], " ", "/@", " ", 
   "list"}], "]"}]}], "Input",
 CellChangeTimes->{{3.568423926548561*^9, 3.568423956431533*^9}, {
   3.568424149323862*^9, 3.568424154258622*^9}, {3.568442989212903*^9, 
   3.568442990762542*^9}, {3.568443430165876*^9, 3.568443430456159*^9}, {
   3.568443587936431*^9, 3.568443588181919*^9}, {3.5684440203077173`*^9, 
   3.568444022138723*^9}, {3.568444193756619*^9, 3.568444194071022*^9}, {
   3.568444297080461*^9, 3.568444297414304*^9}, {3.568444407386209*^9, 
   3.56844440769963*^9}, {3.568445175743435*^9, 3.568445176007494*^9}, {
   3.568445487834955*^9, 3.568445488077731*^9}, {3.568446137513104*^9, 
   3.5684461377599897`*^9}, {3.5684461915796547`*^9, 3.568446192181099*^9}, {
   3.584326312595066*^9, 3.584326312887396*^9}, {3.584327361808247*^9, 
   3.5843273622492313`*^9}, {3.584327460354794*^9, 3.5843274769531803`*^9}, {
   3.5844002520214863`*^9, 3.58440025233075*^9}, {3.594452164621373*^9, 
   3.59445217413203*^9}, {3.594468349805884*^9, 3.594468350160078*^9}, {
   3.594469142731278*^9, 3.594469142967461*^9}, {3.594530190457231*^9, 
   3.594530190627265*^9}, {3.594530778642907*^9, 3.594530780390678*^9}, {
   3.5945308111789207`*^9, 3.594530811525708*^9}, {3.594536386472685*^9, 
   3.5945363866930647`*^9}, {3.594545099528551*^9, 3.594545101216538*^9}, {
   3.59454516326527*^9, 3.594545163606885*^9}, 3.594545446557417*^9, {
   3.594545802887825*^9, 3.594545803117199*^9}, 3.594545937705475*^9, {
   3.5945485149865932`*^9, 3.594548515214222*^9}, {3.594548550062706*^9, 
   3.594548550297447*^9}, {3.59455369763507*^9, 3.594553698756486*^9}, {
   3.5945539321334887`*^9, 3.594553932354805*^9}, {3.59462330848949*^9, 
   3.594623308726379*^9}, {3.594624261190208*^9, 3.594624276135352*^9}, {
   3.59463153251532*^9, 3.594631533019902*^9}, {3.59463360362919*^9, 
   3.594633603853116*^9}, {3.594641409949033*^9, 3.594641410236176*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {EdgeForm[{GrayLevel[0], Thickness[Tiny]}], FaceForm[{GrayLevel[0.85], 
    Opacity[0.1]}], 
    RectangleBox[{0., 9.999999999199992*^-7}, {0., 1.0000000000000008`*^-6}], \

    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{0., 9.999999999599999*^-7}]}}, 
   {EdgeForm[{GrayLevel[0], Thickness[Tiny]}], FaceForm[{GrayLevel[0.85], 
    Opacity[0.1]}], 
    RectangleBox[{1.047200410587506, -0.866020325787827}, \
{1.047200410587506, -0.8660187484229811}], 
    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{1.047200410587506, -0.866019537105404}]}}, 
   {EdgeForm[{GrayLevel[0], Thickness[Tiny]}], FaceForm[{GrayLevel[0.85], 
    Opacity[0.1]}], 
    RectangleBox[{2.0943981355258487`, -0.8660215204842446}, \
{2.0943981355258487`, -0.8660203655365987}], 
    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{2.0943981355258487`, -0.8660209430104217}]}}, 
   {EdgeForm[{GrayLevel[0], Thickness[Tiny]}], FaceForm[{GrayLevel[0.85], 
    Opacity[0.1]}], 
    RectangleBox[{4.188796871252802, -0.86601303606245}, \
{4.188796871252802, -0.8660091480569819}], 
    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{4.188796871252802, -0.8660110920597159}]}}, 
   {EdgeForm[{GrayLevel[0], Thickness[Tiny]}], FaceForm[{GrayLevel[0.85], 
    Opacity[0.1]}], 
    RectangleBox[{5.235996421054185, -0.8660186990765808}, \
{5.235996421054185, -0.8660120769653442}], 
    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{5.235996421054185, -0.8660153880209625}]}}, 
   {EdgeForm[{GrayLevel[0], Thickness[Tiny]}], FaceForm[{GrayLevel[0.85], 
    Opacity[0.1]}], 
    RectangleBox[{7.330395754711373, -0.8660036821071531}, \
{7.330395754711373, -0.8659943201705114}], 
    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{7.330395754711373, -0.8659990011388322}]}}, 
   {EdgeForm[{GrayLevel[0], Thickness[Tiny]}], FaceForm[{GrayLevel[0.85], 
    Opacity[0.1]}], 
    RectangleBox[{8.377594729859283, -0.8660158549347432}, \
{8.377594729859283, -0.8660037487677408}], 
    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{8.377594729859283, -0.866009801851242}]}}, 
   {EdgeForm[{GrayLevel[0], Thickness[Tiny]}], FaceForm[{GrayLevel[0.85], 
    Opacity[0.1]}], 
    RectangleBox[{10.471994682434133`, -0.865994248195087}, \
{10.471994682434133`, -0.8659793823189625}], 
    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{10.471994682434133`, -0.8659868152570247}]}}, 
   {EdgeForm[{GrayLevel[0], Thickness[Tiny]}], FaceForm[{GrayLevel[0.85], 
    Opacity[0.1]}], 
    RectangleBox[{11.51919309615301, -0.8660129646652284}, \
{11.51919309615301, -0.8659953290067203}], 
    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{11.51919309615301, -0.8660041468359743}]}}, 
   {EdgeForm[{GrayLevel[0], Thickness[Tiny]}], FaceForm[{GrayLevel[0.85], 
    Opacity[0.1]}], 
    RectangleBox[{13.613593701102632`, -0.8659846578929048}, \
{13.613593701102632`, -0.8659642222488073}], 
    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{13.613593701102632`, -0.865974440070856}]}}, 
   {EdgeForm[{GrayLevel[0], Thickness[Tiny]}], FaceForm[{GrayLevel[0.85], 
    Opacity[0.1]}], 
    RectangleBox[{14.660791569435965`, -0.8660099968497587}, \
{14.660791569435965`, -0.8659867430561141}], 
    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{14.660791569435965`, -0.8659983699529363}]}}, 
   {EdgeForm[{GrayLevel[0], Thickness[Tiny]}], FaceForm[{GrayLevel[0.85], 
    Opacity[0.1]}], 
    RectangleBox[{14.66073986302976, -0.8660099968497587}, \
{14.66073986302976, -0.8659867430561141}], 
    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{14.66073986302976, -0.8659983699529363}]}}},
  ImageSize->{Automatic, 526.6505802658156}]], "Output",
 CellChangeTimes->{{3.594639655714767*^9, 3.5946396806106052`*^9}, 
   3.5946397946384087`*^9, {3.594639865882085*^9, 3.594639877198197*^9}, {
   3.5946399265007887`*^9, 3.594639954857698*^9}, 3.594640064005047*^9, 
   3.594640113453517*^9, 3.5946401572904882`*^9, 3.594640706807371*^9, 
   3.594640814528763*^9, 3.5946410373484077`*^9, {3.594641393714575*^9, 
   3.594641411475463*^9}, 3.59464216583524*^9}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{{
    GeometricTransformationBox[
     RectangleBox[{-0.5, -0.1}, {0.5, 0.1}], {{{1., 0.}, {0., 1.}}, {9.5, 
      0.}}], 
    {RGBColor[1, 0, 0], PointSize[Large], PointBox[{9.5, 0.}]}}, {
    GeometricTransformationBox[
     RectangleBox[{-1.0923220286581603`, -0.21432079805546936`}, \
{1.0923220286581603`, 0.21432079805546936`}], {{{
      0.5665504748658392, -0.8240270380450461}, {0.8240270380450462, 
      0.5665504748658391}}, {0.6214081315608149, 13.325608330158278`}}], 
    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{0.6214081315608149, 13.325608330158278`}]}}, {
    GeometricTransformationBox[
     RectangleBox[{-1.0923220286581603`, -0.21432079805546936`}, \
{1.0923220286581603`, 0.21432079805546936`}], {{{
      0.5665504748658392, -0.8240270380450461}, {0.8240270380450462, 
      0.5665504748658391}}, {0.6214081315608149, 13.325608330158278`}}], 
    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{0.6214081315608149, 13.325608330158278`}]}}}]], "Input"],

Cell[BoxData[
 GraphicsBox[{{
    GeometricTransformationBox[
     RectangleBox[{-0.5, -0.1}, {0.5, 0.1}], {{{1., 0.}, {0., 1.}}, {9.5, 
      0.}}], 
    {RGBColor[1, 0, 0], PointSize[Large], PointBox[{9.5, 0.}]}}, {
    GeometricTransformationBox[
     RectangleBox[{-0.6590313126798758, -0.37378113420616027`}, \
{0.6590313126798758, 0.37378113420616027`}], {{{
      0.999702138617931, -0.00408050844421667}, {1.4540303622686148`, 
      1.0061298773556313`}}, {0.6214081315608149, 13.325608330158278`}}], 
    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{0.6214081315608149, 13.325608330158278`}]}}, {
    GeometricTransformationBox[
     RectangleBox[{-0.6590313126798758, -0.37378113420616027`}, \
{0.6590313126798758, 0.37378113420616027`}], {{{
      0.999702138617931, -0.00408050844421667}, {1.4540303622686148`, 
      1.0061298773556313`}}, {0.6214081315608149, 13.325608330158278`}}], 
    {RGBColor[1, 0, 0], PointSize[Large], 
     PointBox[{0.6214081315608149, 13.325608330158278`}]}}}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"list", " ", "=", " ", 
   RowBox[{
    RowBox[{"<<", 
     RowBox[{"..", "/", "examples"}]}], "/", 
    RowBox[{"pendulum", ".", "dat"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"pipe2g", "[", 
     RowBox[{"0", ",", "1", ",", "#"}], "]"}], "&"}], " ", "/@", " ", 
   "list"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5943759869763203`*^9, 3.594375999556205*^9}},
 EmphasizeSyntaxErrors->True]
},
AutoGeneratedPackage->None,
WindowSize->{793, 852},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (2013\:5e741\
\:670828\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 22974, 590, 1167, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[23544, 614, 2270, 38, 63, "Input"],
Cell[25817, 654, 4122, 80, 576, "Output"]
}, Open  ]],
Cell[29954, 737, 1023, 19, 447, "Input"],
Cell[30980, 758, 1023, 19, 447, "Input"],
Cell[32006, 779, 613, 18, 63, "Input"]
}
]
*)

(* End of internal cache information *)
